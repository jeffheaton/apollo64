1 OPEN2,2,2:DV=8:MT=1200
2 NP$="":GOTO60000
10 GOTO52000
1000 @P"?";
1001 POKE1021,0:X=1:Y=1:Z=2:C$=F$+",S,R":GOSUB9500:IFE<>0THEN@PA$:CLOSE1:RETURN
1010 POKE847,0:SYS49161:CLOSE1:RETURN
1100 P=1:POKE1021,0
1110 X=1:Y=1:Z=2:C$=F$+STR$(P)+",S,R":GOSUB9500:IFE<>0THENCLOSE1:RETURN
1120 POKE847,0:@P"?":SYS49161:IFPEEK(1020)=0THENGOSUB6700
1130 P=P+1:GOTO1110
1200 TD=DV:TF$=F$:@P"ÕPLOAD":GOSUB2100:@P"UPLOAD NOW!":@KA$
1210 ONPRGOTO53000
1211 GOTO10999
1220 A$="UL:"+F$+"? ":GOSUB3601:RETURN
1250 @P"UPLOAD ABORTED!!":GOTO10999
1300 TD=DV:TF$=F$:@P"ÄOWNLOAD":GOSUB2100
1310 ONPRGOTO54000
1311 GOTO10999
1320 A$="DL:"+F$+"? ":GOSUB3600:RETURN
1350 @P"DOWNLOAD ABORTED!!":GOTO10999
1450 @P"WHAT DOES THIS FILE DO??(?MAX 80CHRS)"
1460 DS$="":@I 1,80,DS$:@P:RETURN
1470 X=LEN(F$):FORA=1TOLEN(F$):Z$=MID$(F$,A,1)
1480 IFZ$=":"ORZ$=","ORZ$="*"ORZ$="?"THENF$=LEFT$(F$,A-1)+"."+RIGHT$(F$,X-A)
1490 NEXT:RETURN
1500 POKE840,DV:SYS49206,"$:"+F$,Y$:BF=PEEK(840)+PEEK(841)*256:RETURN
1600 F$=F$+LEFT$(TB$,X-LEN(F$)):RETURN
1650 CM$=RIGHT$(DC$,LEN(DC$)-22)
1651 DV=VAL(LEFT$(CM$,2))
1652 CM$=RIGHT$(CM$,LEN(CM$)-3):RETURN
1700 @P"×HAT DRIVE(4-15)";:@I1,3,C$:DV=VAL(C$):POKE840,DV
1710 RETURN
1800 A=LEN(A$):A=INT(18-(A/2))-1
1805 @P"";LEFT$(T2$,A);"³";:X$=A$:GOSUB1950:@P"«";
1810 @PLEFT$(T2$,37-POS(0));:RETURN
1900 A$=MB$:@P"?°";:GOSUB1800:@P"®"
1910 @P"Ý?ÆROM:?";:@PNA$;"?";:@PLEFT$(TB$,ABS(37-POS(0)));"Ý"
1920 @P"Ý?#";NU$;LEFT$(TB$,16-POS(0));Y$;"Ý"
1930 A$=SU$:@P"­";:GOSUB1800:@P"½":RETURN
1950 @P"?";X$;"??";:RETURN
2000 @KC$:IFC$=CHR$(13)THENC$="/"
2001 K=PEEK(197):FORZ=1TOLEN(M$):IFC$=MID$(M$,Z,1)THEN2020
2010 NEXT:GOTO2000
2020 AC=VAL(S$(0,8))
2025 IF(VAL(MID$(N$,Z,1))<=AC)ORK<>64THEN@PC$:A$=" "+C$:GOSUB3601:RETURN
2030 A$=" "+C$:GOSUB3601:GOTO2000
2100 @P"PROTOCALL:"
2110 @P"1. PUNTER":MX=1
2120 @P"=->";:@KA$:A=VAL(A$):IFA=0ORA>MXTHEN10999
2130 @PA$;:X=3:C$="+PRT"+STR$(A):PR=A:GOSUB9600:RETURN
2200 IFC$=CHR$(13)THENC$="/"
2201 FORA=1TOLEN(A$):IFMID$(A$,A,1)=C$THENRETURN
2210 NEXT:A=0:RETURN
3000 X=3:Y=5:Z=5:C$="+USERLOG":GOSUB9500
3001 GOSUB3800:IFE<>0THENRETURN
3010 FORX=1TO18:@F,S$(D,X):IFST=0THENNEXT
3020 IFX<18THENFORA=XTO18:S$(D,A)="?":NEXT
3025 IFS$(D,13)="?"ORS$(D,13)="EMPTY"THENS$(D,13)="?"+S$(D,1)+"?"
3030 CLOSE5:RETURN
3100 X=3:Y=5:Z=5:C$="+USERLOG":GOSUB9500:R$=CHR$(13):X$=""
3101 GOSUB3800:R$=CHR$(13)
3102 FORA=1TO18:IFS$(D,A)=""THENS$(D,A)="EMPTY"
3103 NEXT
3110 FORX=1TO18:X$=X$+S$(D,X)+R$:NEXT:PRINT#5,X$:CLOSE5:RETURN
3200 @P"?";:FORA=1TO18:Z$=SS$(A):Z$=Z$+LEFT$(TB$,15-LEN(Z$))
3210 Z$=""+Z$+":?"+S$(D,A):IFIN=2THENZ$=STR$(A)+"-"+Z$
3215 IFIN=0AND((A=2)OR(A=3)OR(A=4)OR(A=7)OR(A=14)OR(A=15)OR(A=17))THEN3230
3220 @PZ$:IFD>12ANDIN=0THEN3240
3230 NEXT
3240 @P"?";:IN=0:RETURN
3300 X=3:Y=5:Z=5:C$="+USERLOG":GOSUB9500:@P"";:I%=1
3310 GOSUB3800:IFE<>0THENRETURN
3311 INPUT#5,Z$,X$,X$,X$,X$,X$,X$,X$:IFZ$="EMPTY"THEN3350
3312 @GC$:IFC$=" "THENCLOSE5:RETURN
3313 IFX$="0"AND(VAL(S$(0,8))>7)THEN@P"";:X$="1":GOTO3350
3329 Y$=STR$(I%):@P"";Y$;" - ?";Z$;"?"
3350 @GA$:IFA$<>""THENI%=I%+1:GOTO3310
3370 RETURN
3400 @P"STARTING AT[";S$(0,12);"]?";:A$=S$(0,12):@I1,6,A$:BY=VAL(A$)
3410 POKE838,FNLB(BY):POKE839,FNHB(BY):RETURN
3600 A$=A$+CHR$(13)
3601 IF(LEN(LG$)+LEN(A$))<240THENLG$=LG$+A$:RETURN
3610 X=3:Y=5:Z=5:C$="+LOG,S,A":GOSUB9500:IFE<>0THEN@P"HOLD"
3620 IFE<>0THENX=3:Y=5:Z=5:C$="+LOG,S,W":GOSUB9500
3630 PRINT#5,LG$:LG$="":CLOSE5:Z=XZ:RETURN
3700 MX%=PEEK(2056+VAL(S$(0,8))):RETURN
3800 FORA=1TO2:PRINT#14,"P"+CHR$(101)+CHR$(FNLB(I%))+CHR$(FNHB(I%))+CHR$(1):NEXT
3810 INPUT#14,E:RETURN
4000 MS%=PEEK(254)+PEEK(255)*256:RETURN
4100 POKE254,FNLB(MS%):POKE255,FNHB(MS%):RETURN
4300 H=FNHB(RC):L=FNLB(RC):RETURN
6000 @P"?ÐLEASE ENTER USER ?ID#, ?HANDLE OR HIT ?<?> FOR USERLOG";
6003 IFID%=0THEN@P" ?<NEW>? FOR NEW USER"
6004 IFID%<>0THEN@P
6005 @P"?>";
6010 C$="":@I1,20,C$:ZZ$=C$
6012 IFC$=""ANDID%=0THENC$="?"
6013 IFC$="?"THENGOSUB3300:GOSUB6700:GOTO6000
6015 IFC$="NEW"ANDID%=0THENRETURN
6020 E=0:IFVAL(C$)<>0THENI%=VAL(C$):GOSUB3000:IFE=0THENRETURN
6021 IFE<>0THEN@P"INVALID ID#":GOTO6000
6030 IFC$=""THENI%=0:RETURN
6035 X=3:Y=5:Z=5:C$="+USERLOG":GOSUB9500:@P"SEARCHING.";:I%=1
6040 @P".";:@GX$:IFX$=" "THEN@P"^P":GOTO6065
6045 GOSUB3800:IFE<>0THEN6065
6050 @F,A$:IFA$=ZZ$THEN6070
6060 I%=I%+1:GOTO6040
6065 @P"NAME NOT ON USERLOG!":I%=0:CLOSE5:GOTO6000
6070 @P"NAME FOUND..USER #";:A$=STR$(I%):@PA$:CLOSE5:RETURN
6100 @P"END OF CONNECTION!!!":FORD=1TO1000:NEXT:CS=PEEK(843)
6110 FORA=1TO3:PRINT#2,"";:FORD=1TO90:NEXT:NEXT:FORD=1TO2000:NEXT
6120 PRINT#2,"ATH0":FORD=1TO2000:NEXT:RETURN
6600 @P"(Y/N)";:X=10
6610 @KC$:IFC$="Y"ORC$="Ù"THEN@P"Y":RETURN
6620 IFC$="N"ORC$="Î"THEN@P"N":RETURN
6621 X=X-1:IFX=0ANDID%=0THEN14500
6630 GOTO6610
6700 @P"?<PAUSE>";
6710 @KA$:IFA$<>" "ANDA$<>CHR$(13)THEN@P"";:GOTO6710
6720 @P:RETURN
7000 POKE659,0:IFMT=300THENPOKE659,6
7010 CS=1.0273E6:A=CS/MT:H=FNHB(A):L=FNLB(A):POKE1000,L:POKE1001,H
7020 IFMT=1200THENPOKE659,8:A=CS/MT*.966:H=FNHB(A):L=FNLB(A)
7040 POKE665,L:POKE666,H:A=CS/MT/2-100:POKE661,FNLB(A):POKE662,FNHB(A)
7050 IFMT=2400THENPOKE661,114:POKE665,132:POKE1000,172:POKE659,10
7070 MT$=STR$(MT):MT$=RIGHT$(MT$,LEN(MT$)-1):MT$=RIGHT$("0000",4-LEN(MT$))+MT$
7080 FORA=1TO4:POKE709+A,ASC(MID$(MT$,A,1)):NEXT:RETURN
9000 X=(16*VAL(MID$(W$,1,1))+VAL(MID$(W$,2,1)))OR(ABS(X$="P")*128)
9010 Y=16*VAL(MID$(W$,3,1))+VAL(MID$(W$,4,1))
9020 Z=16*VAL(MID$(W$,5,1))+VAL(MID$(W$,6,1))
9025 A$=LEFT$(W$,2):B$=RIGHT$(W$,4):A=VAL(A$):A=A+12:A$=STR$(A)
9026 A$=RIGHT$(A$,LEN(A$)-1):IFX$="P"THENW$=A$+B$
9030 POKE832,VAL(Y$):POKE831,VAL(Z$):TI$=W$:POKE56587,X:POKE56586,Y:POKE56585,Z
9040 POKE56584,0:POKE862,VAL(ZZ$):RETURN
9100 X$=STR$(PEEK(832)):X$=RIGHT$(X$,LEN(X$)-1):IFVAL(X$)<10THENX$="0"+X$
9110 Z$=STR$(PEEK(831)):Z$=RIGHT$(Z$,LEN(Z$)-1):IFVAL(Z$)<10THENZ$="0"+Z$
9111 W$=STR$(PEEK(862)):W$=RIGHT$(W$,LEN(W$)-1):IFVAL(W$)<10THENW$="0"+W$
9120 Z$=X$+"/"+Z$+"/"+W$:RETURN
9200 X$="A.M.":X=VAL(MID$(Y$,1,2)):IFX<=12THEN9230
9210 X$=STR$(X-12):X$=RIGHT$(X$,LEN(X$)-1):IFX<22THENX$="0"+X$
9220 Y$=RIGHT$(Y$,LEN(Y$)-2):Y$=X$+Y$:X$="P.M."
9230 Y$=MID$(Y$,1,2)+":"+MID$(Y$,3,2)+" "+X$+" - "+Z$:RETURN
9300 Y$=TI$:GOSUB9100:GOSUB9200:RETURN
9400 N$=STR$(N):N$=RIGHT$(N$,LEN(N$)-1):N$=LEFT$("0000",4-LEN(N$))+N$:RETURN
9500 CM$=DV$(X,0):GOSUB1651:CLOSEY:CC$=C$
9501 DV$=DV$(X,1):IFFD=1ANDC$="+USERLOG"THEN9510
9502 CLOSE14:OPEN14,DV,15:PRINT#14,CM$
9510 DV$=DV$(X,1):IFC$<>""THENOPENY,DV,Z,DV$+":"+C$
9515 INPUT#14,A$,B$,C$,D$:E=VAL(A$)
9520 A$="DOS ERROR:"+A$+B$+"  T:"+C$+"  S:"+D$+CHR$(13)+"FILE:"+CC$:RETURN
9600 CM$=DV$(X,0):GOSUB1651:CLOSE14:OPEN14,DV,15:PRINT#14,CM$:CLOSEY:CC$=C$
9610 SYS49170,C$,DV:RETURN
9700 CM$=DV$(X,0):GOSUB1651:CLOSE14:OPEN14,DV,15:PRINT#14,CM$:CLOSEY:CC$=C$
9710 PRINT#14,C$:RETURN
9800 X=VAL(LEFT$(Z$,2)):Z=VAL(RIGHT$(Z$,2)):Y=VAL(MID$(Z$,4,2))
9810 Z=Y+X*32+Z*365:RETURN
10000 GOSUB7000:PRINT#2,IS$:POKE828,0:ID%=0:POKE833,0:POKE830,0:C$=""
10010 POKE2048,80:PRINT"?";VR$:SYS49152:POKE54296,0
10011 PRINTPEEK(851)" CALLERS."
10020 GET#2,A$:A=ASC(A$+CHR$(9)):A=AAND127
10021 IFPEEK(850)=0THENPOKE850,255:GOTO55300
10022 IF(PEEK(852)=0)AND(VAL(TI$)<40000)AND(LEN(NP$)>3)THEN53200
10030 GETZ$:IFZ$=""THEN10060
10031 A$="L123A TCRSMN":C$=Z$:GOSUB2200
10032 IFA=0THEN10060
10033 ONAGOTO10400,10091,10092,10093,10035,10000,55000,55200,10036,55500,55300
10034 ONA-11GOTO53200:GOTO10060
10035 C$="RING":GOTO10080
10036 RUN
10060 IFA=13THEN10080
10070 A$=CHR$(A):IFVAL(A$)<>0THEN10075
10071 IFA<65ORA>90THEN10020
10075 C$=C$+A$:GOTO10020
10080 IFLEN(C$)>1THENPRINT"?MODEM:";TB$:PRINT"?MODEM:?";C$
10081 IFC$="RING"THENMT=MX:GOSUB7000:POKE849,PEEK(56577)AND16:PRINT#2,"AT X1A"
10082 IFC$="CONNECT"THEN10093
10083 IFC$="CONNECT12"THEN10091
10084 IFC$="CONNECT24"THEN10092
10085 C$="":GOTO10020
10090 POKE833,255:GOTO10100
10091 MT=1200:GOSUB7000:GOTO10090
10092 MT=2400:GOSUB7000:GOTO10090
10093 MT=300:GOSUB7000:GOTO10090
10100 POKE53280,0:POKE847,0:POKE829,255:POKE828,0:@P"?";VR$;"HIT RETURN":T=0
10110 POKE861,0:POKE857,0:@KC$:IFC$=CHR$(13)THEN10125
10111 IFC$=""THEN53100
10112 T=T+1:IFT<>10THEN10110
10120 GOTO14500
10125 @P"?HIT BACKSPACE OR DELETE->";:X=0
10127 @KC$:IFC$=CHR$(20)THENC$="Y":GOTO10150
10128 IFC$=CHR$(8)THENC$="N":GOTO10150
10130 IFC$=B$THEN10140
10135 B$=C$:X=X+1:IFX<>5THEN10127
10137 GOTO14500
10140 @P"ÁRE YOU USING A ÃÏÍÍÏÄÏÒÅ GRAPHICSTERMINAL?";:GOSUB6600
10150 IFC$="Y"THEN@P"COLOR MODE!":POKE829,0:GOTO10175
10170 IFC$="N"THEN@P"ASCII OR ANSI MODE":POKE828,1:POKE829,255
10171 @P"CAN YOU DISPLAY ANSI";:GOSUB6600:IFC$="Y"THENPOKE828,2:@P"ANSI MODE"
10175 POKE851,PEEK(851)+1:TR=3:F$="+TITLE":GOSUB1100:GOSUB62300:@P"?"
10180 D=0:GOSUB6000:IFC$="NEW"THEN11000
10181 IFS$(0,1)="EMPTY"THEN10200
10190 @P"PASSWORD>";:@I0,30,A$:IF(PEEK(197)<>64)OR(A$=S$(0,2))THEN10208
10195 A$="HACK:"+STR$(I%)+"/"+A$:GOSUB3600
10200 TR=TR-1:IFTR=0THEN14500
10205 C$=STR$(TR):@P"WRONG,";C$;" TRY(S) LEFT!":GOTO10180
10208 C$=LEFT$(S$(0,7),8):@P">?";C$;:@I0,4,A$:IFPEEK(197)<>64THEN10210
10209 IFA$<>RIGHT$(S$(0,7),4)THEN10195
10210 FORA=0TO9:POKE700+A,32:NEXT:FORA=1TOLEN(S$(0,1))
10211 POKE699+A,(ASC(MID$(S$(0,1),A,1)))AND63:IFA<10THENNEXT
10212 C$=CHR$(13):C$=C$+C$+"?"+S$(0,1):GOSUB9100:Y$=TI$:GOSUB9200:C$=C$+Y$
10213 C$=C$+" AT "+STR$(MT):GOSUB3600:A$=C$:GOSUB3600
10215 @P"?* * ?ÂÂÓ ÓÔÁÔÓ? * *":X=VAL(S$(0,16)):S$(0,16)=STR$(X+1)
10220 @P"ÃALLS TODAY:?";:C$=STR$(PEEK(850)):@PC$
10222 GOSUB9100:IFZ$<>S$(0,3)THENS$(0,5)=S$(0,4)
10225 @P"ÌOCAL TIME :?";:GOSUB9100:Y$=TI$:GOSUB9200:@PY$
10226 @P"ÔOTAL CALLS:?";:C$=STR$(CN):@PC$:@PVR$:CN=CN+1
10230 @P"ÔHE SYSOP IS ";SY$;".":ID%=I%
10240 @P"* * ";S$(0,13);"'S STATS? * *"
10250 D=0:IN=0:GOSUB3200:POKE835,VAL(S$(0,4))
10251 X=FNA(2049):Z=VAL(S$(0,12)):IFZ<LMTHENZ=LM
10252 X=X-Z:IFX<0THENX=0
10253 IFX<>0THENX$=STR$(X):@P"?ÎEW POSTS:";X$
10260 X=3:Y=5:Z=5:C$="+CALLS,S,R":GOSUB9500:IFE<>0THEN@PA$:GOTO10330
10270 FORA=1TO5:INPUT#5,M$(A):NEXT:CLOSE5:GOSUB6700
10280 @P"?LAST FEW CALLERS:"
10290 FORA=1TO5:@P"?";M$(A);"?":NEXT
10300 PRINT#15,"S:+CALLS":X=3:Y=5:Z=5:C$="+CALLS,S,W":GOSUB9500
10310 FORA=2TO5:PRINT#5,M$(A):NEXT:C$=STR$(MT):IFPEEK(833)=0THENC$="LOCAL"
10320 A$=">"+S$(0,1)+" - "+C$+"":PRINT#5,A$:CLOSE5:GOTO10350
10330 @P"MAKING CALLER LOG":X=3:Y=5:Z=5:C$="+CALLS,S,W":GOSUB9500
10340 FORA=1TO5:PRINT#5,"N/A":NEXT:CLOSE5:GOTO10400
10350 F$="+HELLO":GOSUB1100:GOSUB21000
10360 F$="+NOTE"+STR$(VAL(S$(0,8))):GOSUB1100
10400 IFS$(0,12)="*"THEN55000
10403 IFID%=0THEN10100
10404 POKE846,255:IFSS$(1)=""THENGOSUB60030
10405 IFS$(0,4)="N/A"THENCM$=S$(0,4)
10410 GOSUB11500
10411 IFPEEK(835)=0ANDS$(0,4)<>"N/A"THEN@P"TIME LIMIT!":GOTO14500
10429 M$=CM$(0):N$=AC$(0):GOSUB2000
10440 ONZGOTO 12000,14000,12200,22000,23000,40010,13200,12300,43300
10450 ON(Z-9)GOTO35000,32000,35100,33000,35200,33500,35300,13000,32500
10460 ON(Z-18)GOTO12600,12610,36200
10461 IFC$="0"ORVAL(C$)<>0THENF$=C$:GOTO51000
10989 GOTO10040
10990 IFID%=0THEN14500
10991 GOTO10400
10999 FD=0:POKE847,0:POKE857,0:POKE859,0:POKE198,0:CLOSE1:GOTO10400
11000 ID%=30000:F$="+NEWTITLE":GOSUB1000:GOSUB6700:@P"??WHAT IS YOUR HANDLE:"
11010 @P">?";:@I1,40,S$(0,1):IFS$(0,1)=""ORS$(0,1)="EMPTY"THEN11010
11020 @P"HOLD.";:I%=0:X=3:Y=5:Z=5:C$="+USERLOG":GOSUB9500
11030 @P".";:GOSUB3800:IFE<>0THEN11050
11031 @F,A$:IFA$=S$(0,1)THEN@P"ALREADY A MEMBER":D=0:GOSUB3000:GOTO10190
11035 IFA$="EMPTY"ANDI%<ID%THENID%=I%
11036 IFASC(A$)=255THEN11050
11040 I%=I%+1:GOTO11030
11050 IFID%=30000THENID%=I%
11060 @P"?PICK A PASSWORD:";:@I1,10,S$(0,2)::IFS$(0,2)=""THEN11060
11070 @P"REAL NAME:";:@I1,20,S$(0,17):IFS$(0,17)=""THEN11070
11080 @P"VOICE NUMBER(314/638-8330):":@I1,12,C$:IFLEN(C$)<>12THEN11080
11081 R$=RIGHT$(C$,8):P$=LEFT$(R$,1):IFP$="0"ORP$="1"THEN11080
11082 IFLEFT$(R$,3)="911"THEN11080
11083 IFMID$(C$,4,1)<>"/"THEN11080
11084 IFMID$(C$,8,1)<>"-"THEN11080
11090 S$(0,7)=C$:X=3:Y=5:Z=5:C$="+BLACK LIST":GOSUB9500:IFE=0THEN11110
11095 @F,A$:S=ST:IFA$=S$(0,7)THEN@P"LATER LAMER!":GOTO14500
11100 IFS=0THEN11095
11101 X=3:Y=5:Z=5:C$="+NEWUSER,S,R":GOSUB9500:IFE<>0THEN11210
11110 @P"?PLEASE ANSWER THE FOLLOWING QUESTIONS"
11111 C$="":X=3:Y=0:GOSUB9500
11120 CLOSE6:OPEN6,DV,6,DV$+":+FEEDBACK,S,A"
11130 CLOSE7:OPEN7,DV,7,DV$+":+RECORD,S,A":CLOSE8
11140 OPEN8,DV,8,DV$+":+LOG,S,A":PRINT#8,CHR$(13);"?NEW USER:";S$(0,1);ID%
11150 CLOSE5:OPEN5,DV,5,DV$+":+NEWUSER,S,R"
11160 PRINT#6,"VAL":PRINT#6,"INFO":PRINT#6,S$(0,1):PRINT#6,ID%:PRINT#6,TI$
11170 GOSUB9100:PRINT#6,Z$:PRINT#6,S$(0,1)+STR$(ID%)
11180 @F,A$:S=ST:B$=CHR$(13)+""+A$+":":@PB$:@I1,80,C$:PRINT#6,B$:PRINT#6,C$
11190 PRINT#7,A$:PRINT#7,C$:PRINT#8,B$:PRINT#8,C$:IFS=0THEN11180
11200 PRINT#6,CHR$(1);:CLOSE5:CLOSE6:CLOSE7:CLOSE8
11210 S$(0,3)="?":S$(0,4)="10":S$(0,5)="10":S$(0,6)="2":S$(0,13)=S$(0,1)
11220 FORA=8TO12:S$(0,A)="0":NEXT
11230 @P"CAN YOU DISPLAY 80 COL";:GOSUB6600:S$(0,15)=C$:S$(0,16)=""
11240 @P"HOW MANY LINES PER PAGE>";:@I1,2,A$:S$(0,14)=STR$(VAL(A$))
11250 S$(0,18)="NONE":D=0:I%=ID%:GOSUB3100
11260 @P"?×ELCOME ?";S$(0,1);"?!ÙOUR PASSWORD IS ";S$(0,2)
11270 I$=STR$(ID%):@P"AND YOUR ID# IS";I$;".":@KA$
11280 IFLEFT$(S$(0,7),3)<>"314"THEN10210
11290 F$="+VALIDATION 1":GOSUB1000:@P"DO YOU WANT ON-LINE VALIDATION?";
11300 GOSUB6600:IFC$="N"THEN10210
11310 F$="+VALIDATION 2":GOSUB1000:GOSUB6700:GOSUB6100
11320 PRINT#2,"ÁÔÄÐ "+RIGHT$(S$(0,7),8):T=3000:POKE2040,0
11330 T=T-1:PRINT"?WAITING:"T:IFT=0THENRUN
11340 IFPEEK(842)<>255THEN11330
11350 @P"?APOLLO64 ON-LINE VALIDATOR"
11360 @P"PASSWORD>";:@I1,30,A$:IFA$<>S$(0,2)THEN11360
11370 D=0:GOSUB11600:@P"YOU ARE NOW VALIDATED!":FORD=1TO500:NEXT:GOTO10210
11500 N=INT(5*RND(0))+1:@P"SYSOP SAYS:";AD$(N):@P"TIME:?";:
11510 GOSUB9100:Y$=TI$:GOSUB9200:@PY$
11520 CM$=STR$(PEEK(835)):C$="Â??°À®???Ý Ý???­À½???? ?"
11525 IFS$(0,4)="N/A"THENCM$=S$(0,4)
11530 @P"?TIME LEFT=";CM$;"? <MENU-?>? ?-=>";C$;:RETURN
11600 S$(D,4)="60":S$(D,5)="60":S$(D,8)="5":S$(D,11)="300"
11610 S$(D,9)="0":S$(D,10)="0":S$(D,12)="0":S$(D,8)="5":RETURN
12000 @P"?DO YOU WANT ME TO PAGE THE SYSOP,"
12005 @P"REMEMBER SYSOP IS:";SY$;"!PAGE SYSOP";:GOSUB6600
12010 IFC$="N"THENGOTO10999
12015 IF(PEEK(53280)AND15)=2THENF$="+STILLNOCHAT":GOSUB1000:GOTO24000
12016 S=54272:POKES+0,150:POKES+1,150:POKES+5,8:POKES+6,248:POKES+4,17
12020 POKE54296,15:POKE53280,2:@P"?PAGING SYSOP:"
12025 FORA=1TOLEN(CT$):A$=MID$(CT$,A,1)+"":@PA$;:FORD=1TO500:NEXT
12030 GETA$:IFA$="?"THEN12050
12040 NEXT:@P"?":F$="+NOCHAT":GOSUB1000:GOSUB6700:@P"?"
12041 GOSUB24000:GOTO10999
12050 @P"?":SYS49173:GOTO10999
12200 @P"?SELECT A TERM:1. COMMODORE2. ASCII3. IBM ANSI>";:@KA$:@PA$
12201 POKE829,255:X=(VAL(A$)AND3)-1:IFX<0THEN10999
12210 POKE828,X:IFX=0THENPOKE829,0
12220 GOTO10999
12300 F$="+MENU"+STR$(VAL(S$(0,8))):GOSUB1000:GOTO10999
12500 GOSUB21500:GOTO10999
12600 AR=4:Y$="+TXT":Z$="TEXT FILES":GOTO36000
12610 AR=5:Y$="+HLP":Z$="HELP FILES":GOTO36000
13000 TR=0
13020 IF(MT=1200ORMT=2400)ANDTR=0THEN@P"FOR 300 ONLY!":GOTO10999
13030 @P"NEW BAUD RATE(50-600,1200,2400)";:@I1,4,C$:MT=VAL(C$)
13031 IFTR<>0ANDMT<=2400THEN13050
13040 IFMT<50ORMT>600THEN13030
13050 @P "CHANGE YOUR TERMINAL TO ";C$;"BAUD,THEN HIT RETURN.":GOSUB7000
13060 @KC$:GOTO10999
13200 GOSUB24000:GOTO10999
14000 @P"?LOGOFF:?<Y>?-LOG OFF,?<F>?-FEEDBACK"
14010 @P"?<N>?-MESSAGE TO NEXT USER,?<Q>?-QUICK"
14020 @P"?CTRL-P BACK TO BBS."
14030 @KA$:IFA$="Q"THEN14500
14040 IFA$="F"THEN24000
14050 IFA$="N"THENGOSUB62200:GOTO14000
14060 IFA$<>"Y"THEN14030
14070 CS=255:@P"?";:F$="+BYE":GOSUB1100
14500 GOSUB6100:FORA=3TO14:CLOSEA:NEXT:POKE2040,40:PRINT"?LOGOFF SETUP."
14510 IFID%=0THENPRINT"?":GOTO10000
14520 :
14530 S$(0,12)=STR$(PEEK(2049)+PEEK(2050)*256)
14540 IFS$(0,4)<>"N/A"THENS$(0,5)=STR$(PEEK(835))
14550 GOSUB9100:S$(0,3)=Z$:D=0:I%=ID%:GOSUB3100
14560 :
14570 IFCS=0THENA$="LOST CARRIER":GOSUB3610
14580 IFCS=255THENA$="?LOGOFF":GOSUB3610
14585 GOSUB14700:X=3:C$="I0":GOSUB9700:X=3:C$="S:+MESSAGE BASE":GOSUB9700
14587 POKE840,DV:SYS49200
14590 X=3:C$="S:+HOLD":GOSUB9700:X=3:Y=5:Z=5:C$="+HOLD,S,W":GOSUB9500
14591 IFS$(0,1)=""THENS$(0,1)="N/A"
14592 IFSY$=""THENSY$="OUT"
14593 PRINT#5,S$(0,1):PRINT#5,CN:PRINT#5,SY$:PRINT#5,LM:CLOSE5:RUN
14600 @P"BBS CRASH!!":A$=""+CHR$(13)+"BBS CRASH!":GOSUB3600
14610 GOTO10999
14700 CLOSE14:OPEN14,VAL(DV$(2,0)),15
14701 IF(FNA(2049)-LM)<50THEN14710
14705 PRINT#14,"S0:+MSG"+STR$(LM):PRINT"SCR:"LM;FNA(2049)-LM:LM=LM+1:GOTO14700
14710 RETURN
19921 IFZ$="C"THEN55200
20000 ID$=STR$(ID%):OU=0:POKE859,0:ID$="("+RIGHT$(ID$,LEN(ID$)-1)+")":POKE857,0
20010 FF$=F$:F$="+MSG TXT3":GOSUB1000:F$=FF$
20050 WW=1:POKE845,0:@P"ÆÒÏÍ:??";S$(0,13);ID$;"?":POKE859,0
20060 GOSUB9100:AA$=TI$:BB$=Z$:L=1:CS$=""
20070 IFWW=-1THENPOKE845,255
20071 POKE1020,0:C$="":@MC$
20090 IFL=44THEN@P".....MESSAGE FULL...SAVING...":C$="S"
20100 M$(L)=C$:L=L+1:IFPEEK(1020)=0THEN@P"":REMGOTO20070
20101 IFC$=""THENL=L-1
20105 IFPEEK(1020)<>0THENC$=CHR$(PEEK(1020)):POKE845,0
20110 IFC$="U"THENCS$=CHR$(142):@PCS$;"PPERCASE":L=L-1:GOTO20070
20120 IFC$="L"THENCS$="":@PCS$;"OWERCASE":GOTO20070
20121 IFC$="W"THENWW=-WW:IFWW=-1THEN@P"ORD WRAP:OFF":GOTO20070
20122 IFC$="W"ANDWW=1THEN@P"ORD WRAP:ON":POKE845,0:GOTO20070
20123 IFC$="S"ANDL=1THENM$=CHR$(20)+"ABORT":@PM$:GOTO20340
20130 IFC$="S"THEN@P"END":GOTO20350
20140 IFC$<>"E"THEN20070
20145 @P"DIT"
20150 POKE847,0:@P"EDITOR COMMANDS:"
20160 @P"<E>DIT,<C>ONTINUE,<A>BORT,<L>IST,<S>END"
20170 M$="ECALS":N$="00000":GOSUB2000:ONZGOTO20270,20320,20340,20190,20350
20180 GOTO20150
20190 @P"ÌINE NUMBERS";:GOSUB6600
20200 NA$=S$(0,1):GOSUB1900
20240 FORA=1TOL-1:IFC$="Y"THENZ$=STR$(A)+":"+M$(A):@PZ$;
20250 IFC$="N"THEN@PM$(A);
20260 NEXT:GOTO20150
20270 @P"LINE NUMBER>";:@I1,3,C$
20280 Z=VAL(C$):IFZ<1ORZ>LTHEN20150
20290 @P"OLD LINE:";M$(Z);"RETYPE IT:"
20300 @MM$(Z)
20310 @P"LINE CHANGED":GOTO20150
20320 @P"?";CS$;""
20330 FORZ=1TOL-1:@PM$(Z):NEXT:GOTO20070
20340 @P"ÎO MESSAGE SENT!!":OU=255:FD=0:POKE857,PEEK(859):RETURN
20350 FD=0:WT=0:CLOSE5:@P"SENDING MESSAGE..":C$=F$:IFRIGHT$(F$,2)=",A"THENFD=1
20351 IFRIGHT$(F$,2)=",W"THENWT=1
20352 DB=WT+FD:IFDB=0THENX=2:Y=5:Z=5:C$="":GOSUB9500:IFFD=0THENC$=F$+",S,W"
20353 IFDB=0THENPRINT#14,"S"+DV$(2,1)+":"+F$
20354 IFWT=1THENCLOSE5:OPEN5,DV,5,C$:GOTO20360
20355 X=2:IFFD=1THENX=3
20356 Y=5:Z=5:GOSUB9500:IFE<>0THEN@PA$:GOTO10999
20360 IFWT=0THENPRINT#5,NU$:PRINT#5,MB$:PRINT#5,S$(0,13)+ID$:PRINT#5,ID%
20370 IFWT=0THENPRINT#5,AA$:PRINT#5,BB$:PRINT#5,SU$:PRINT#5,CS$;:X$=CHR$(13)
20371 IFWT=0THENPRINT#5,X$+"MESSAGE FROM:?"+S$(0,1)+"?."+X$
20380 FORA=1TO(L-1):PRINT#5,M$(A);:NEXT:IFWT=0THENPRINT#5,"";
20390 CLOSE5:POKE857,PEEK(859):FD=0:RETURN
20500 X=2:Y=1:Z=2:C$=F$+",S,R":GOSUB9500:POKE859,0
20501 INPUT#1,NU$,MB$,NA$:OU=0
20502 IFE<>0THENOU=1:RETURN
20520 INPUT#1,I%
20530 INPUT#1,Y$,Z$:@P"";:GOSUB9200:DA$=Y$
20540 INPUT#1,SU$:GOSUB1900:L=1:@P""
20541 POKE1021,0:IFS$(0,15)="Y"THENPOKE1021,1
20550 POKE847,0:SYS49161:SS=ST:POKE847,0:POKE859,0:RETURN
21000 @P"?ÃHECKING YOUR MAILBOX..."
21010 X=2:Y=5:Z=5:C$="+PVT"+STR$(ID%)+"/ 1":GOSUB9500:IFE=0THEN21030
21020 @P"?ÓORRY YOUR MAIL BOX IS EMPTY.":RETURN
21030 @P"?ÓCANNING MAIL:":N=1
21040 X=2:Y=5:Z=5:C$="+PVT"+STR$(ID%)+"/"+STR$(N)+",S,R":GOSUB9500
21045 IFE<>0THEN21070
21050 INPUT#5,A$,A$,A$:@P"";A$
21060 N=N+1:GOTO21040
21070 @P"ÒEAD MAIL NOW";:NN=1:GOSUB6600:IFC$="N"THENRETURN
21080 AR=2:F$="+PVT"+STR$(ID%)+"/"+STR$(NN):GOSUB20500
21090 @P"<R>EREAD,<A>UTOREPLY,<H>OLD,<D>ELETE"
21100 M$="RAHD":N$="0000":GOSUB2000:ONZGOTO21080,21220,21120,21140
21110 GOTO 21090
21120 NN=NN+1:IFNN<NTHEN21080
21130 @P"ÅND OF MAIL!":RETURN
21140 @P"ÄELETING MESSAGE!";:PRINT#14,"I0"
21150 F$="S:"+F$:PRINT#14,F$
21160 N=N-1:FORZ=NNTON
21170 X$="+PVT"+STR$(ID%)+"/"+STR$(Z)
21180 Y$="+PVT"+STR$(ID%)+"/"+STR$(Z+1):Z$="R0:"+X$+"="+Y$
21190 PRINT#14,Z$:@P".";:NEXT
21200 @P"ÍESSAGE DELETED."
21210 IFNN<NTHEN21080
21211 GOTO21130
21220 @P"ÁUTOREPLY!"
21230 Z1=N:Z2=NN:GOSUB21500:N=Z1:NN=Z2:GOTO21080
21500 D=1:GOSUB3000:AR=2:D=1:GOSUB3000:@P"ÐRIVATE MAIL TO:";S$(1,1)
21510 MB$="PRIVATE MAIL":NU$="+PVT":SU$="MAIL TO "+S$(1,1):N=1
21520 @P"ÐLEASE WAIT VERIFING NAME.";
21530 X=2:Y=5:Z=5:C$="+PVT"+STR$(I%)+"/"+STR$(N):GOSUB9500:IFE<>0THEN21550
21540 @P".";:N=N+1:GOTO21530
21550 F$="+PVT"+STR$(I%)+"/"+STR$(N):AR=2:GOSUB20000:RETURN
22000 F$="+MSG TXT2":GOSUB1000:@P"-=>";:@KA$:@PA$
22010 ONVAL(A$)GOTO22110,22030,22024,13200:@P"":GOTO10999
22024 GOSUB21000:GOTO10999
22030 @P"PRIVATE MAIL":D=1:GOSUB6000:IFI%=0THEN10999
22090 GOTO 12500
22110 @P"?ÐOST A MESSAGE?":GOSUB3700:SYS49182,MX%:Y=MX%:@P""
22120 @P"?×HAT BASE>";
22130 @KC$:IFC$=""THEN10999
22131 Z=ASC(C$+CHR$(0))-65:IFZ<0ORZ>YTHEN22130
22140 ZX=Z:POKE1020,Z:SYS49203Z$
22150 @PZ$:N%=PEEK(2049)+PEEK(2050)*256:MB$=Z$
22160 @P"SUBJECT>";:@I1,20,SU$:NU$=STR$(N%):AR=2
22170 F$="+MSG"+STR$(N%):NU$=RIGHT$(NU$,LEN(NU$)-1):GOSUB20000:IFOU=255THEN10999
22180 POKE1020,ZX:SYS49191A$:@P"ÍESSAGE SENT.":POKE852,PEEK(852)+1:GOTO 10999
23000 @P"??ÒEAD MESSAGES?":POKE857,VAL(S$(0,14)):BY=VAL(S$(0,12))
23001 GOSUB3410:GOSUB3700:SYS49179,MX%:Z=MX%:RR=Z
23010 @P"??×HAT BASE,?RETURN? FOR ALL NEW-->";:RT=0:NS%=0
23020 @KC$:Z%=ASC(C$)-65
23030 IFC$=CHR$(13)THENGOSUB3400:MB%=0:RT=1:GOTO23095
23031 IF(Z%<0)OR(Z%>Z)THEN23020
23040 GOSUB3400
23090 MB%=Z%
23095 POKE1020,MB%:SYS49203A$:GOSUB4000
23100 GOSUB4100:SYS49185:MG=PEEK(1020):GOSUB4000:IFPEEK(1020)=50THEN23190
23101 IFPEEK(836)=255ANDPEEK(837)=255THEN23100
23102 M%=PEEK(836)+PEEK(837)*256
23105 RE=0:GOSUB4100:SYS49185:IF(PEEK(1020)<>1)AND(PEEK(1020)<>50)THENRE=1
23106 F$="+MSG"+STR$(M%):GOSUB20500:IFOU=1THEN23250
23107 IFRE=1THENP@P"MESSAGE HAS REPLIES"
23108 @GA$:IFNS%=255THEN@GA$:@P"<NONSTOP>":GOTO23100
23110 POKE857,VAL(S$(0,14)):@P"COMMAND?(?)?-->";:POKE857,VAL(S$(0,14))
23120 C$=CHR$(13)
23121 M$="ARQ/S-+JN?P":N$="0000800000":GOSUB2000
23122 ONZGOTO23130,23106,10999,23100,23220,23180,23190,23127,23124,23125,23126
23124 NS%=255:GOTO23100
23125 @P"?";:F$="+MSG TXT1":GOSUB1001:GOTO23110
23126 GOSUB21500:GOTO23106
23127 GOSUB4100
23128 SYS49185:IFPEEK(1020)=0THEN23128
23129 SYS49188:GOSUB4000:GOTO23100
23130 @P"AUTOREPLY!"
23140 @P"ARE YOU SURE";:GOSUB6600:IFC$="N"THEN23101
23150 IFLEFT$(SU$,2)<>"R)"THENSU$="R)"+SU$
23160 NU$=STR$(PEEK(2049)+PEEK(2050)*256):F$="+MSG"+NU$
23170 AR=2:GOSUB20000:IFOU=255THEN23100
23175 GOSUB4100:SYS49194:GOSUB4100:POKE852,PEEK(852)+1:GOTO23100
23180 GOSUB4100:SYS49188:GOSUB4000:GOTO23101
23190 IFRT=0THEN@P"END OF SEARCH":GOTO10999
23200 MB%=MB%+1:IFMB%<RRTHEN23095
23210 RT=0:GOTO23190
23220 @P"SCRATCH MESSAGE..ARE YOU SURE";:GOSUB6600
23230 IFC$="N"THEN 23110
23250 MS%=MS%-2:GOSUB4100:SYS49197:SYS49188:GOSUB4000
23270 X=2:C$="S:"+F$:GOSUB9700:IFOU=0THEN@P"MESSAGE SCRATCHED!"
23280 GOTO23100
24000 @P"SEND FEEDBACK TO SYSOP";:GOSUB6600
24010 IFC$="N"THEN10999
24050 X=3:Y=1:Z=5:C$="+FEEDBACK,S,R":GOSUB9500:IFE=0THEN24060
24051 @P"EMAIL FEEDBACK":I%=1:D=1:GOSUB3000:GOTO12500
24060 MB$="FEEDBACK":NU$="PVT":SU$="FEEDBACK":@P"?"
24070 F$="+FEEDBACK,S,A":GOSUB20000:IFOU=0THENPOKE855,PEEK(855)+1
24080 CLOSE1:RETURN
30000 X=3:Y=5:Z=5:C$="+CATALOGS,S,R":GOSUB9500:XB=1:IFE=1THEN@PA$:GOTO10999
30010 @P"?DISKS:"
30015 INPUT#5,A$,I%:S=ST:J=VAL(S$(0,8))
30020 IFJ>=I%THENA$=" "+CHR$(XB+64)+" ?  "+A$:@PA$:N=N+1
30030 @P"";:XB=XB+1:IFS=0THEN30015
30040 @P"?DISK>";
30050 @KC$:CD%=ASC(C$)-64:IFCD%>JORCD%<=0THEN30050
30060 @PC$;:RETURN
31000 Z=0:IFCD%=0THENCD%=1
31010 X=3:Y=5:Z=5:C$="+CATALOG"+STR$(CD%)+",S,R":@P"??";:GOSUB9500
31011 INPUT#5,A$:@PA$:INPUT#5,A$:POKE847,0:@P"";A$:UP$=MID$(A$,23,1)
31012 INPUT#5,A$:@PA$:DO$=MID$(A$,23,1):INPUT#5,A$:@PA$:CR$=MID$(A$,23,1)
31013 @F,A$:@PA$:@F,A$:S=ST:@PA$;"":DC$=A$:Z=1:IFS<>0THEN31040
31014 @P"EXTENDED LIST";:GOSUB6600:AA$=C$
31020 @F,A$:S=ST:IFAA$="N"THENA$=LEFT$(A$,37)
31021 A$=""+STR$(Z)+"."+A$:@GB$:IFB$=" "THEN@P"^P":GOTO31120
31030 Z=Z+1:@PA$:IFS=0THEN31020
31040 GOSUB1650
31100 CLOSE14:OPEN14,DV,15:PRINT#14,CM$
31110 F$="$":GOSUB1500:BF$=STR$(BF):BF$=RIGHT$(BF$,LEN(BF$)-1)
31120 @P"?";BF$;" BLOCKS FREE.   CREDITS:";
31130 @PS$(0,11):RETURN
31500 X=3:Y=5:Z=5:C$="+CATALOG"+STR$(CD%)+",S,R":GOSUB9500
31510 INPUT#5,A$,A$,A$,A$,A$,CM$:GOSUB1650:CLOSE5
31515 CLOSE14:OPEN14,DV,15:PRINT#15,CM$
31520 GOSUB1360:X=17:GOSUB1650:STOP
32000 GOSUB30000:GOSUB 31000
32010 @P"?INSERT>";:@I1,16,F$
32020 @P"IS ?";F$;"? RIGHT?";:GOSUB6600:IFC$="N"THEN10999
32035 GOSUB1450:GOSUB32600:@P"FILE ADDED!":GOTO10999
32500 GOSUB30000:GOSUB 31000
32510 @P"DELETE FILE#?";:@I1,2,F$:IFVAL(F$)=0THEN10999
32520 @P"SCRATCH  ";F$;"?";:GOSUB6600:IFC$="N"THEN10999
32535 F%=VAL(F$):C$="":X=3:Y=5:Z=5:GOSUB9500:PRINT#14,"S0:+++":@P"HOLD.";
32540 X=3:Y=5:Z=5:C$="+CATALOG"+STR$(CD%)+",S,R":GOSUB9500
32541 CLOSE6:OPEN6,DV,6,DV$+":+++,S,W":C=-6
32550 C=C+1:@F,A$:S=ST:IFC=F%THEN32560
32555 PRINT#6,A$
32560 @P".";
32561 IFS=0THEN32550
32570 CLOSE5:CLOSE6:Z$="+CATALOG"+STR$(CD%):PRINT#14,"S:"+Z$
32580 PRINT#14,"R:"+Z$+"=+++":GOTO10999
32600 GOSUB1650:CLOSE14:OPEN14,DV,15:PRINT#14,CM$:GOSUB1500
32610 IFY$<>"P"ANDY$<>"S"ANDY$<>"U"THEN@P"":GOTO10999
32611 F$=F$+","+Y$:X=18:GOSUB1600:F$="?"+F$:N=BF:GOSUB9400
32620 F$=F$+"BLKS="+N$+" K="
32630 N=INT((N*254)/1024):IFN=0THENN=1
32640 GOSUB9400:F$=F$+N$+"?":GOSUB9100
32650 F$=F$+"UPLOADED ON "+Z$+" BY "+S$(0,1):F$=F$+"?"+DS$+""
32660 GOSUB1470:CLOSE5:OPEN5,8,5,"+CATALOG"+STR$(CD%)+",S,A":PRINT#5,F$
32670 CLOSE5:RETURN
33000 GOSUB30000:GOSUB31000
33010 @P"?UPLOAD(#,$)>";:TT=PEEK(835)
33030 F$="":@I1,16,F$:IFF$=""OR((LEFT$(F$,1)="+")ANDVAL(S$(0,8))<8)THEN10999
33031 IFF$="$"THENGOSUB31000:GOTO33010
33032 IFF$="#"THENGOSUB30000:GOTO33010
33033 CLOSE14:OPEN14,DV,15:CLOSE5:OPEN5,DV,5,"0:"+F$:INPUT#14,E:IFE=0THEN10999
33035 GOSUB1450
33036 IFUP$="N"THEN@P"":GOTO10999
33040 GOSUB1200:F$=TF$:IFOU=99THEN10999
33041 GOSUB1500:L=BF:IFS$(0,11)="N/A"ORCR$="N"THEN33045
33042 IFDS$=""THEN@P"SORRY 1/2 CREDIT!":L=L/2
33043 CR=VAL(S$(0,11)):CR=CR+L*VAL(S$(0,6)):S$(0,11)=STR$(CR)
33045 S$(0,9)=STR$(VAL(S$(0,9))+L)
33060 POKE835,TT:GOSUB32600:GOTO10999
33500 IFCD%=0THENGOSUB30000
33510 GOSUB31000:@P"?DOWNLOAD(#,$)?>";
33530 F$="":@I1,16,F$:IFF$=""THEN10999
33531 FORA=1TOLEN(F$):IFMID$(F$,A,1)=","THEN37000
33532 NEXT:IFF$="$"THENGOSUB31000:GOTO33510
33533 IFF$="#"THENGOSUB30000:GOTO33510
33534 IFVAL(F$)=0THENGOSUB34000:IFOU=0THEN33700
33535 IFVAL(F$)=0THEN33540
33538 GOSUB34100:IFOU=0THEN33700
33540 @P"?";FF$:GOSUB34200
33560 T=.3+L*255/MT/6+L*3/255+L*0.15:T=INT(T*10)/10
33565 T$=STR$(T):@P"X-FER TIME:";T$
33567 IFDO$="N"THEN@P"":GOTO10999
33568 IFCR$="N"THEN33590
33569 CR=L:TM=T
33570 IFS$(0,11)<>"N/A"ANDVAL(S$(0,11))<LTHEN@P"NOT ENOUGH CREDITS!":GOTO33510
33590 IF(PEEK(835)<T)AND(S$(0,4)<>"N/A")THEN@P"NOT ENOUGH TIME";:GOTO33510
33600 GOSUB1300:IFOU=99THEN10999
33610 IFS$(0,11)="N/A"THEN10999
33620 IFCR$<>"N"THENS$(0,11)=STR$(VAL(S$(0,11))-L)
33621 S$(0,10)=STR$(VAL(S$(0,10))+L)
33630 GOTO10999
33700 @P"FILE NOT FOUND":GOTO33510
34000 CLOSE5:OPEN5,8,5,"0:+CATALOG"+STR$(CD%)+",S,R":FORA=1TO6:INPUT#5,A$:NEXT
34005 @P"HOLD.":X$="?"+F$
34010 @F,FF$:IFLEFT$(FF$,LEN(X$))=X$THENDS$=FF$:CLOSE5:OU=1:RETURN
34030 IFST=0THEN@P".";:GOTO34010
34040 OU=0:RETURN
34100 CLOSE5:OPEN5,8,5,"0:+CATALOG"+STR$(CD%)+",S,R":Z=VAL(F$):@P"HOLD.";
34110 FORA=1TO6:INPUT#5,A$:NEXT
34120 FORA=1TOZ:@F,FF$:@P".";
34135 IFST<>0THENOU=0:RETURN
34140 NEXT:OU=1:RETURN
34200 L=VAL(MID$(FF$,27,4)):F$=LEFT$(FF$,20):X$=F$
34210 Z=20
34220 IFMID$(F$,Z,1)<>" "THEN34340
34230 Z=Z-1:GOTO34220
34340 F$=LEFT$(X$,Z-2):F$=RIGHT$(F$,LEN(F$)-2):Y$=MID$(X$,Z,1):RETURN
35000 GOSUB30000:GOSUB31000:GOTO10999
35100 GOSUB31000:GOTO10999
35200 I%=ID%:GOSUB43100:GOTO10999
35300 @P"?";:F$="+INFO":GOSUB1000:GOSUB6700:@P"?";:GOTO10999
36000 L=0
36010 C$=Y$+STR$(L)
36011 X=AR:Y=1:Z=5:GOSUB9500:IFE<>0ANDL=0THEN@PA$:@P"NO FILES SETUP!":GOTO10999
36012 IFE<>0THEN@P"EMPTY":GOTO36020
36013 @P"?":POKE1021,0:SYS49161:X$=STR$(L)
36020 @P"?";Z$;"#";X$;"? ?<?-MENU>? +NEXT -PREV?>";:C$="":@I1,6,C$
36021 IFC$=""THEN10999
36022 IFVAL(C$)<>0THENL=VAL(C$):GOTO36010
36023 A$="+-?/":GOSUB2200:ONAGOTO36040,36070,36000:GOTO36020
36040 L=L+1:GOTO36010
36070 L=L-1:GOTO36010
36200 @P"??ÎEW ÓCAN:?ÓCAN ALL UPLOADS SINCE:(?";S$(0,3);"?)>";
36210 Z$=S$(0,3):@I11,10,Z$:GOSUB9800:CD=Z
36220 CT=1:X=3:Y=6:Z=6:C$="+CATALOGS,S,R":GOSUB9500
36221 CLOSE5:OPEN5,DV,5,DV$+":+CATALOG"+STR$(CT)+",S,R"
36222 INPUT#6,N$,AC$:SS=ST
36230 IFAC$>S$(0,8)THEN10999
36235 @P"SCANNING:";N$
36240 FORA=1TO6:@F,A$:NEXT
36250 @F,A$:S=ST:Z$=MID$(A$,52,8):GOSUB9800:IFZ>CDTHEN@PA$
36260 IFS=0THEN36250
36370 IFSS=0THENCT=CT+1:GOTO36221
36380 GOTO10999
37000 F=0:M$(0)="":TC=0:TT=0
37010 FORP=1TOLEN(F$)
37020 IFMID$(F$,P,1)=","THENF=F+1:M$(F)="":GOTO37031
37030 M$(F)=M$(F)+MID$(F$,P,1)
37031 NEXT
37035 FORH=0TOF:F$=M$(H):IFVAL(F$)=0THENGOSUB34000:IFOU=0THEN37100
37036 IFVAL(M$(H))=0THEN37050
37040 GOSUB34100:IFOU=0THEN37100
37050 @P"?";FF$;"":GOSUB34200
37060 T=.3+L*255/MT/6+L*3/255+L*0.15:T=INT(T*10)/10:A$=STR$(T):X=TC+L:Y=TT+T
37070 @P"TRANSFER TIME:";A$
37071 IF(X>VAL(S$(0,11)))ANDS$(0,11)<>"N/A"THEN@P"NEED MORE CREDITS":GOTO37110
37080 IF(Y>PEEK(835))ANDS$(0,4)<>"N/A"THEN@P"NOT ENOUGH TIME":GOTO37110
37090 TT=Y:TC=X:GOSUB1650:POKE840,DV:GOSUB1500:M$(H)=F$+","+Y$
37095 NEXT:GOTO37120
37100 @P"FILE NOT FOUND"
37110 M$(H)="*":GOTO37095
37120 X=3:C$="+PRT 1":GOSUB9600
37121 @P"SELECT MULTI REC(CTRL-P TO ABORT)":FORD=1TO4000:NEXT
37130 B=0:FORA=0TOF:IFM$(A)="*"THEN37190
37160 F$=M$(A)
37170 T$=RIGHT$(M$(A),1):TY$="UPS":FORZ=1TO3
37180 IFMID$(TY$,Z,1)=T$THENT=Z-1
37190 NEXT
37191 PRINT#2,"					"+M$(A):W=0:IFB=5THEN10999
37192 W=W+1:@GA$:IFA$="G"ORA$="O"THEN37195
37193 IFW=500THENB=B+1:W=0:GOTO37192
37194 GOTO37192
37195 PRINT:PRINTF$:POKE1020,T:SYS61310:@J,40981:@J,40972:IFPEEK(512)=1THEN1350
37200 CLOSE5:OPEN5,DV,5,M$(A)+",R":POKE1021,255:SYS61310:@J,40981:@J,40966
37210 CLOSE5:IFPEEK(512)=1THEN1250
37215 F$=M$(A):GOSUB1500:CR=VAL(S$(0,11))-BF:S$(0,11)=STR$(CR)
37220 NEXT:FORD=1TO100:NEXT:PRINT#2,"			":GOTO10999
40000 GOTO40100
40010 @P"?";:F$="+COSYSOP 1":GOSUB1000
40050 @P"SYSTEM PASSWORD."
40060 @P"?>";:@I0,20,C$:K=PEEK(197)
40080 IFC$<>SP$ANDPEEK(197)=64THEN10999
40100 F$="SYSOP:"+S$(0,1)+"? ?<?=MENU>?-->":@PF$;
40150 M$=CM$(1):N$=AC$(1):GOSUB2000
40170 ONZGOTO41000,42000,45000,45500,46000,43000,41200,43500,10999,44000,44500
40185 IFC$="0"ORVAL(C$)<>0THEN41100
40999 GOTO40100
41000 F$="+COSYSOP 2":GOSUB1000:@P""
41010 GOTO40999
41100 F$="SYSOP "+C$:GOTO51000
41105 @P"ÕSER LOG:";:GOSUB3300:GOTO40000
41110 RETURN
41200 @P"?SYSTEM LOG:":X=3:Y=1:Z=5:C$="+LOG,S,R":GOSUB9500:IFETHEN@PA$
41210 SYS49161:@P"CLEAR FILE";:GOSUB6600:IFC$="Y"THENPRINT#15,"S:+LOG"
41220 IFC$="Y"THENX=3:Y=5:Z=5:C$="+LOG,S,W":GOSUB9500
41230 GOTO40000
42000 @P"??FEEDBACK:"
42010 CLOSE5:X=3:Y=1:Z=8:C$="+FEEDBACK,S,R":GOSUB9500:IFE<>0THEN42070
42011 INPUT#1,A$:IFST<>0THEN@P"EMPTY!":GOTO40000
42020 @P"?":GOSUB20501:@P"<A>UTOREPLY,<Q>UIT,<E>DIT,<RET>NEXT"
42030 @KA$:IFA$=CHR$(13)THEN42065
42040 IFA$="E"THENGOSUB43100:GOTO42000
42050 IFA$="Q"THEN40000
42060 IFA$="A"THENKP=0:GOSUB21500:GOTO42000
42065 GET#1,A$:IFST=0THEN42020
42070 CLOSE1:@P"?CLEAR FILE";:GOSUB6600:WT=0
42080 IFC$="Y"THENPRINT#14,"S0:+FEEDBACK":X=3:Y=5:Z=5:C$="+FEEDBACK,S,W":WT=1
42090 IFWT=1THENGOSUB9500:PRINT#5,"<F>"
42095 @P"DONE.":CLOSE5:GOTO40000
43000 GOSUB9100:Y$=TI$:GOSUB9200:@P"?ÓET TIME."
43010 @P"?CURRENT TIME STATUS:";Y$
43020 @P"×ANT TO CHANGE IT";:GOSUB6600:IFC$="N"THEN40999
43030 @P"PLEASE ENTER TIME(HHMMSS)>";:@I1,8,W$:POKE840,255
43040 @P"<Á>M OR <Ð>M->";:@I1,1,X$
43050 @P"MONTH>";:@I1,2,Y$
43060 @P"DATE >";:@I1,2,Z$
43065 @P"YEAR >19";:@I1,2,ZZ$
43070 GOSUB9000:IFS$(0,12)="/"THEN10000
43080 GOTO40999
43100 IFI%=ID%THEND=0:S$(0,5)=STR$(PEEK(835)):GOTO43105
43101 D=1:GOSUB3000
43105 A$=STR$(I%):@P"?USER:";S$(D,1);" -";A$:IN=2:GOSUB3200
43108 A$="":@P"?EDIT WHAT(1-18,V=VALIDATE,D=DELETE)";:@I1,3,A$:X=PEEK(197)
43110 Y=VAL(A$):IFA$="0"THEN43130
43111 IFA$="V"THENGOSUB11600:GOTO43105
43112 IFA$="D"THENFORA=1TO18:S$(D,A)="EMPTY":NEXT:GOTO43105
43113 IFA$=""THENRETURN
43114 IFVAL(S$(0,8))<9AND(X=64)ANDY=16THENY=1
43115 IF(((Y<12)AND(VAL(S$(0,8))<9))ANDX=64)ANDY<>2THEN@P"":GOTO10999
43116 IFY=13THENGOSUB43151:S$(D,13)=A$:GOTO43105
43117 IFA$="D"ANDID%=I%THENY=8:X=0:GOTO43114
43118 IFA$="D"THENFORA=1TO17:S$(D,A)="EMPTY":NEXT
43119 IFA$="V"AND((VAL(S$(0,8))>9)OR(X<>64))THENGOSUB11600:GOTO43105
43120 @PSS$(Y);">";:@I1,30,A$:S$(D,Y)=A$
43121 GOTO43105
43130 IFI%=ID%THENPOKE835,VAL(S$(0,5)):RETURN
43140 @P"WRITE STATS";:GOSUB6600:IFC$="N"THENRETURN
43150 @P"WRITING STATS":D=1:GOSUB3100:RETURN
43151 A$=""
43152 POKE847,0:@P"?GRAPHIC INPUT:?";A$;
43153 @KC$:C=ASC(C$):IFC=8ORC=9ORC=29ORC=8ORC=145ORC=157ORC=147ORC=19THENC=256
43154 IFC=148ORC=133ORC=256ORC=17OR(C<>20ANDC<>13ANDPOS(0)>35)THEN43152
43155 IFC=20ANDA$<>""THENA$=LEFT$(A$,LEN(A$)-1):GOTO43152
43156 IFC<>13THENA$=A$+C$
43157 IFC<>13ANDLEN(A$)<>70THEN43152
43158 @P"?";A$:IFPOS(0)<37THENRETURN
43159 B$=STR$(POS(0)-37):@P"";B$;" CHRS TOO LONG":@KB$:GOTO43152
43300 @P"?ÕSER ZAPER-INSTANT LEV 1 ACCESS"
43310 D=1:GOSUB6000
43320 IFI%=0THEN10999
43330 @PS$(1,1);" GETS LEVEL 1";:GOSUB6600
43340 IFC$="Y"THENS$(1,8)="1":D=1:@P"WRITING STATS":GOSUB3100
43350 GOTO10999
43500 @P"?USER EDITOR?
43510 D=1:GOSUB6000:IFI%=0THEN40000
43520 GOSUB43100:GOTO40000
44000 @P"ÕPLOAD FILE TO SYSTEM DISK"
44010 @P"PLEASE ENTER FILE NAME>";:@I1,16,F$:IFF$=""THEN40000
44025 GOSUB1700
44030 GOSUB1200:IFS$(0,12)="*"THEN55010
44040 GOTO40000
44500 @P"ÄOWNLOAD A FILE FROM SYSTEM DISK"
44510 @P"PLEASE ENTER FILE NAME>";:@I1,16,F$:IFF$=""THEN40000
44530 GOSUB1700:GOSUB1300:IFS$(0,12)="*"THEN55010
44540 GOTO40000
45000 @P"?MAKE WHAT FILE>";:@I1,16,F$:IFF$=""THEN40000
45010 GOSUB1700:F$=F$+",S,W":GOSUB20000:GOTO40000
45500 @P"??READ WHAT FILE>";:@I1,16,F$:IFF$=""THEN40000
45501 GOSUB1700:CLOSE1:CLOSE14:OPEN14,DV,15:OPEN1,DV,5,F$+",S,R":INPUT#14,E
45502 IFE<>0THEN40000
45510 @P"?":POKE1021,0:SYS49161:@KC$:GOTO40000
46000 @P"?ÁPOLLO64 DOS COMMANDS"
46001 GOSUB1700:C$=STR$(DV):CLOSE14:OPEN14,DV,15:PRINT#14,""
46010 @P"";C$;"@";:C$="":@I1,40,C$:IFC$=""THEN40000
46011 A$="DOS:"+C$:GOSUB3600
46015 IFLEFT$(C$,1)="N"THEN@P"ÎICE ÔRY!":GOTO40000
46017 IFLEFT$(C$,1)="$"THENCLOSE127:@DC$:GOTO40000
46018 IFLEFT$(C$,2)="D:"THENC$=RIGHT$(C$,LEN(C$)-2):CLOSE127:@DC$
46020 PRINT#14,C$:@P"":INPUT#14,A$,B$,C$,D$
46030 @P"";A$;B$;C$;D$:@KA$:GOTO40000
51000 POKE1020,0
51010 POKE2040,0:@P"?PROGRAM LOADING......":F$="+OVL "+F$:@L,F$,VAL(DV$(6,0))
52000 IFID%=0THENPOKE850,1:RUN
52010 GOTO10999
53000 @J,40981:@J,40969:IFPEEK(512)=1THEN1250
53010 T$="UPSP":T$=","+MID$(T$,PEEK(1020)+1,1):PRINT"USER UPLOADING:";TF$;T$
53020 CLOSE5:OPEN5,TD,5,TF$+T$+",W":SYS61310:@J,40981:@J,40963:CLOSE5
53030 GOTO1220
53100 X=0:IFNP$=""THEN14500
53110 X=X+1:@P"NET>";:@I0,20,A$:IFA$=NP$THEN53140
53120 IFX=10THEN14500
53130 GOTO53110
53140 FORA=1TO30:@P"/";:NEXT:F$="NET1":GOTO51000
53200 POKE2048,0:PRINT"?NETWORK CALL OUT":F$="NET2":GOTO51000
54000 DV=TD:F$=TF$:GOSUB1500:TY$="UPS":FORA=1TO3
54001 IFMID$(TY$,A,1)=Y$THENT=A-1:GOTO54003
54002 NEXT:@P"FILE NOT FOUND":GOTO10999
54003 @P"DOWNLOAD NOW!":@KA$:POKE1020,T:SYS61310:POKE1020,T:F$=TF$+","+Y$+",R"
54004 @J,40981:@J,40972:IFPEEK(512)=1THEN1350
54005 CLOSE5:OPEN5,TD,5,F$:POKE1021,255:SYS61310:@J,40981:@J,40966:CLOSE5
54006 IFPEEK(512)=1THEN1250
54008 RETURN
55000 PRINT#2,"ÁÔÚ":S$(0,12)="*"
55001 POKE2040,0:POKE833,100:PRINT"?ÁPOLLO64 ÂÂÓ ÍINIÔERM":SYS49164:POKE861,0
55010 PRINT:PRINT"OPTIONS:"
55020 PRINT"<U>-UPLOAD,<D>-DOWNLOAD,<S>SEND CMD":POKE833,0
55030 PRINT"<B>BAUD RATE,<G>GFX MODE,<@>DOS,<X>IT"
55040 GETC$:IFC$=""THEN55040
55050 A$="UDSBGX":GOSUB2200:ONAGOTO44000,44500,55140,55130,12200,55120:GOTO55000
55120 RUN
55130 PRINT:INPUT"BAUD RATE";MT:GOSUB7000:GOTO55001
55140 PRINT"?COMMAND:";@I1,200,A$
55150 PRINT#2,A$:PRINT"<S>END AGAIN,<T>ERM":@KA$:IFA$="T"THEN55001
55160 GOTO55150
55200 POKE2040,0:PRINT"?":CLOSE5:OPEN5,8,5,"+SYSTEM CRASH,P,R":INPUT#15,E
55210 IFE<>0THENPRINT"NO CRASHES":RUN
55220 SYS49170,"+SYSTEM CRASH",8
55230 GETA$:IFA$=""THEN55230
55240 PRINT#15,"I0":PRINT#15,"S:+SYSTEM CRASH":RUN
55300 T=5:T$=TI$:POKE2040,0:PRINT"?":POKE850,255
55310 PRINT"SYS MAINT IN";STR$(T);" SECONDS"
55311 PRINT"<SPACE> TO ABORT!"
55320 IFTI$<>T$THENT$=TI$:T=T-1:IFT=0THEN55350
55330 GETA$:IFA$=""THEN55310
55340 RUN
55350 F$="EVENT":GOTO51000
55500 POKE2040,0:INPUT"?THE SYSOP IS:";SY$:GOTO14590
60000 VR$="RUNNING:? APOLLO64 ?V1.0 ?#0003":POKE2040,0:PRINT"?";VR$
60005 POKE830,0:POKE847,0:POKE859,0
60010 SYS49152:POKE54296,0:DIMS$(1,18),M$(50),SS$(18),DV$(6,1),AD$(5),AC$(1)
60020 DIMCM$(1):DEFFNA(X)=PEEK(X)+PEEK(X+1)*256
60030 DEFFNH(X)=INT(PEEK(X)/256):DEFFNL(X)=X-FNH(X)*256
60040 DEFFNHB(X)=INT(X/256):DEFFNLB(X)=X-FNHB(X)*256
60050 PRINT"+CONFIG":OPEN5,DV,5,"0:+CONFIG,S,R"
60060 FORA=0TO1:@F,CM$(A):@F,AC$(A):NEXT:@F,SP$:FORA=1TO6:FORB=0TO1:@F,DV$(A,B)
60070 NEXTB,A:@F,CT$:FORA=1TO5:@F,AD$(A):NEXT:@F,TB$:INPUT#5,T2$,IS$,MX$
60080 MX=VAL(MX$):CLOSE5:PRINT"+HOLD":X=3:Y=5:Z=5:C$="+HOLD,S,R":GOSUB9500
60090 INPUT#5,LC$,CN,SY$,LM:CLOSE5
60100 :
60110 CLOSE15:OPEN15,8,15:X=3:Y=5:Z=5:C$="+DATA":GOSUB9500:IFE<>0THEN@PA$:STOP
60115 FORA=1TO18:@F,SS$(A):NEXT
60130 IFPEEK(2048)<>0THEN10000
60500 C$="+MESSAGE BASE":PRINTC$:X=3:GOSUB9600:S$(0,12)="/":POKE53272,23
60510 POKE2040,0:PRINT"?";VR$:PRINT:PRINT
60520 GOTO43030
60540 GOTO10000
62200 @P"?AUTOMESSAGE:(4 LINES)"
62201 @P"HIT RETURN AT END OF EACH LINE."
62220 @I1,40,A1$:@I1,40,A2$:@I1,40,A3$:@I1,40,A4$:CLOSE5
62221 @P"SAVING AUTO MESSAGE...":DV=VAL(DV$(3,0)):CLOSE14:OPEN14,DV,15
62230 PRINT#14,"S0:+AUTO":OPEN5,DV,5,"0:+AUTO,S,W":PRINT#5,A1$:PRINT#5,A2$
62240 PRINT#5,A3$:PRINT#5,A4$:PRINT#5,"BY:";S$(0,1):CLOSE5:RETURN
62300 X=3:Y=5:Z=5:C$="+AUTO,S,R":GOSUB9500:IFE<>0THENRETURN
62305 @P"?* * * AUTO MESSAGE * * *"
62310 FORA=1TO5:A$="":@F,A$:@P"";A$:NEXT:GOSUB6700:RETURN

